import{k as u,n as d,f as m,ao as D,b as s,c as l,ap as i,al as f,aj as h,E as y,o as p,j as r,_ as $,h as P}from"./index-4791bb42.js";import{_}from"./VCheckbox-45eeed32.js";import{c as L,a as v,b}from"./VDataTable-7fa4aa40.js";import{_ as F}from"./VFileInput-c07a06f3.js";class w{getAll(){return u.get("/PDFDocumentLayout")}getPDFDocumentLayoutById(t){return u.get(`/PDFDocumentLayout/${t}`)}addPDFDocumentLayout(t){return u.post("/PDFDocumentLayout",t)}deletePDFDocumentLayout(t){return u.delete(`/PDFDocumentLayout/${t}`)}updatePDFDocumnetLayout(t,e){return u.put(`/PDFDocumentLayout/${t}`,e)}}const c=new w,x={name:"pdfDocumentLayoutForm",props:{value:Boolean,PDFDocumentLayout:{type:Object}},computed:{show:{get(){return this.value},set(o){this.$emit("input",o)}}},data(){return{PDFLayoutAttachment:void 0,form:{companyCode:"",documentType:"",isDefault:0,attachmentDto:{attachmentName:"",attachmentType:"",attachmentFile:[]}},itemsDocumentType:["Invoice","Reminder"],formValid:!1}},methods:{async getAsByteArray(o){return console.log("going to convert"),await this.readFile(o)},readFile(o){return new Promise((t,e)=>{const a=new FileReader;a.addEventListener("loadend",n=>t(n.target.result)),a.addEventListener("error",e),a.readAsDataURL(o)})},async submitForm(o){this.$store.commit("setIsLoading",!0);const t=this.PDFLayoutAttachment;this.form.attachmentDto.attachmentType=".xml",this.form.attachmentDto.attachmentName=t.name,this.form.attachmentDto.attachmentFile=await this.getAsByteArray(t),this.form.attachmentDto.attachmentFile=this.form.attachmentDto.attachmentFile.substr(this.form.attachmentDto.attachmentFile.indexOf(",")+1),await c.addPDFDocumentLayout(o).then(e=>{console.log("succesfully uploaded!"),this.$toast.success("succesfully uploaded!"),this.$refs.form.reset()}).catch(e=>{console.log(e),this.$toast.error(e.message)}),this.$store.commit("setIsLoading",!1)}}};var T=function(){var t=this,e=t._self._c;return e(L,{model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("div",{staticClass:"Admin doc template"},[e(m,{staticClass:"pa-2",attrs:{outlined:"",tile:""}},[e(D,[e(s,{attrs:{icon:""},on:{click:function(a){a.stopPropagation(),t.show=!1}}},[e(l,[t._v("mdi-close")])],1),e(i,[t._v("Voeg een document template toe")]),e(i,[t._v("Update een document template")]),e(f),e(s,{attrs:{disabled:!t.formValid},on:{click:function(a){return t.submitForm(t.form)}}},[t._v("Opslaan")])],1),e(h,{ref:"form",attrs:{"lazy-validation":""},model:{value:t.formValid,callback:function(a){t.formValid=a},expression:"formValid"}},[e("div",{staticClass:"form-group"},[e(y,{attrs:{counter:50,label:"Bedrijf",required:""},model:{value:this.$props.PDFDocumentLayout.companyCode,callback:function(a){t.$set(this.$props.PDFDocumentLayout,"companyCode",a)},expression:"this.$props.PDFDocumentLayout.companyCode"}})],1),e("div",{staticClass:"form-group"},[e(v,{attrs:{items:t.itemsDocumentType,label:"Type document",required:""},model:{value:t.form.documentType,callback:function(a){t.$set(t.form,"documentType",a)},expression:"form.documentType"}})],1),e(_,{attrs:{"true-value":1,"false-value":0,label:"Standaard voor dit bedrijf?"},model:{value:t.form.isDefault,callback:function(a){t.$set(t.form,"isDefault",a)},expression:"form.isDefault"}}),e(F,{attrs:{accept:".jrxml"},model:{value:t.PDFLayoutAttachment,callback:function(a){t.PDFLayoutAttachment=a},expression:"PDFLayoutAttachment"}}),e("div",{staticClass:"form-group"})],1)],1)],1)])},C=[],A=d(x,T,C,!1,null,null,null,null);const k=A.exports,I={name:"pdfDocumentLayoutList",data(){return{showPDFDocumentLayoutForm:!1,updateForm:!1,layouts:[],headers:[{text:"Id",align:"start",sortable:!1,value:"pdfdocumentLayoutId"},{text:"Bedrijf",value:"companyCode",sortable:!0},{text:"DocumentType",value:"documentType",sortable:!0},{text:"Standaard",value:"isDefault",sortable:!0},{text:"Acties",value:"actions",sortable:!1}],attachmentHeaders:[{text:"Template file",align:"start",value:"attachment",sortable:!1},{text:"Acties",value:"attachmentActions",sortable:!1}],page:1,count:0,pageSize:10,PDFLayoutAttachment:void 0,pdfDocumentLayoutDto:{companyCode:"",documentType:"",isDefault:0,attachmentDto:{attachmentName:"",attachmentType:"",attachmentFile:[]}},itemsDocumentType:["DOCTYPE_INVOICE","DOCTYPE_REMINDER"],formValid:!1,formRules:{companyCodeRules:[o=>!!o||"Bedrijfscode is verplicht"],documentTypeRules:[o=>!!o||"DocumentType is verplicht"],attachmentRules:[o=>!!o||"Bijlage is verplicht"]}}},methods:{async retrievePDFDocumentLayouts(){this.$store.commit("setIsLoading",!0),await c.getAll().then(o=>{this.layouts=o.data.pdfDocumentLayouts}).catch(o=>{console.log(o),this.$toast.error(o.message)}),this.$store.commit("setIsLoading",!1)},async deletePDFDocumentLayout(o){this.$store.commit("setIsLoading",!0),await c.deletePDFDocumentLayout(o).then(t=>{for(let e=0;e<this.layouts.length;++e)this.layouts[e].pdfdocumentLayoutId===o&&this.$delete(this.layouts,e);this.$toast.success("Succesvol verwijderd PDF layout met id: "+o)}).catch(t=>{console.log(t),this.$toast.error(t.message)}),this.$store.commit("setIsLoading",!1)},async updatePDFDocumentLayout(o){this.$store.commit("setIsLoading",!0),await c.getPDFDocumentLayoutById(o).then(t=>{this.form=t.data,this.updateForm=!0,this.showPDFDocumentLayoutForm=!0}).catch(t=>{console.log(t),this.$toast.error(t.message)}),this.$store.commit("setIsLoading",!1)},resetUpdateForm(){this.updateForm=!1},async getAsByteArray(o){return await this.readFile(o)},readFile(o){return new Promise((t,e)=>{const a=new FileReader;a.addEventListener("loadend",n=>t(n.target.result)),a.addEventListener("error",e),a.readAsDataURL(o)})},async submitForm(){this.$store.commit("setIsLoading",!0);const o=this.PDFLayoutAttachment;this.pdfDocumentLayoutDto.attachmentDto.attachmentType=".xml",this.pdfDocumentLayoutDto.attachmentDto.attachmentName=o.name,this.pdfDocumentLayoutDto.attachmentDto.attachmentFile=await this.getAsByteArray(o),this.pdfDocumentLayoutDto.attachmentDto.attachmentFile=this.pdfDocumentLayoutDto.attachmentDto.attachmentFile.substr(this.pdfDocumentLayoutDto.attachmentDto.attachmentFile.indexOf(",")+1),await c.addPDFDocumentLayout(this.pdfDocumentLayoutDto).then(t=>{this.$toast.success("succesfully uploaded!"),this.layouts.push(t.data),this.$refs.form.reset(),this.showPDFDocumentLayoutForm=!1}).catch(t=>{console.log(t),this.$toast.error(t.message)}),this.$store.commit("setIsLoading",!1)},removeAttachment(){this.form.attachmentDto=""}},watch:{showPDFDocumentLayoutForm:function(o,t){o||(this.resetUpdateForm(),this.$refs.form.reset())}},mounted(){this.retrievePDFDocumentLayouts()},components:{PDFDocumentLayoutForm:k}};var R=function(){var t=this,e=t._self._c;return e(p,{staticClass:"list px-3 mx-auto",attrs:{"align-content":"center"}},[e(r,{attrs:{cols:"12",sm:"4"}},[e(s,{attrs:{small:""},on:{click:function(a){a.stopPropagation(),t.showPDFDocumentLayoutForm=!0}}},[t._v(" Toevoegen ")])],1),e(L,{model:{value:t.showPDFDocumentLayoutForm,callback:function(a){t.showPDFDocumentLayoutForm=a},expression:"showPDFDocumentLayoutForm"}},[e("div",{staticClass:"Admin doc template"},[e(m,{staticClass:"pa-2",attrs:{outlined:"",tile:""}},[e(D,[e(s,{attrs:{icon:""},on:{click:function(a){a.stopPropagation(),t.showPDFDocumentLayoutForm=!1}}},[e(l,[t._v("mdi-close")])],1),t.updateForm?e(i,[t._v("Update een document template")]):e(i,[t._v("Voeg een document template toe")]),e(f),e(s,{attrs:{disabled:!t.formValid},on:{click:function(a){return t.submitForm()}}},[t._v("Opslaan")])],1),e(h,{ref:"form",model:{value:t.formValid,callback:function(a){t.formValid=a},expression:"formValid"}},[e("div",{staticClass:"form-group"},[e(y,{attrs:{counter:50,label:"Bedrijf",rules:t.formRules.companyCodeRules},model:{value:t.pdfDocumentLayoutDto.companyCode,callback:function(a){t.$set(t.pdfDocumentLayoutDto,"companyCode",a)},expression:"pdfDocumentLayoutDto.companyCode"}})],1),e("div",{staticClass:"form-group"},[e(v,{attrs:{items:t.itemsDocumentType,label:"Type document",rules:t.formRules.documentTypeRules},model:{value:t.pdfDocumentLayoutDto.documentType,callback:function(a){t.$set(t.pdfDocumentLayoutDto,"documentType",a)},expression:"pdfDocumentLayoutDto.documentType"}})],1),e(_,{attrs:{"true-value":1,"false-value":0,label:"Standaard voor dit bedrijf?"},model:{value:t.pdfDocumentLayoutDto.isDefault,callback:function(a){t.$set(t.pdfDocumentLayoutDto,"isDefault",a)},expression:"pdfDocumentLayoutDto.isDefault"}}),t.updateForm&&t.pdfDocumentLayoutDto.attachmentDto!=""?e("div",[e(p,[e(r,{attrs:{cols:4}},[e("a",{attrs:{href:`data:application/octet-stream;base64,${t.pdfDocumentLayoutDto.attachmentDto.attachmentFile}`,download:`${t.pdfDocumentLayoutDto.attachmentDto.attachmentName}.${t.pdfDocumentLayoutDto.attachmentDto.attachmentType}`}},[t._v(" "+t._s(t.pdfDocumentLayoutDto.attachmentDto.attachmentName)+"."+t._s(t.pdfDocumentLayoutDto.attachmentDto.attachmentType)+" ")])]),e(r,{attrs:{cols:2}},[e(l,{attrs:{large:""},on:{click:function(a){return t.removeAttachment()}}},[t._v(" mdi-delete ")])],1)],1)],1):t._e(),e(F,{attrs:{accept:".jrxml",label:"Jasper report file",rules:t.formRules.attachmentRules},model:{value:t.PDFLayoutAttachment,callback:function(a){t.PDFLayoutAttachment=a},expression:"PDFLayoutAttachment"}}),e("div",{staticClass:"form-group"})],1)],1)],1)]),e(r,{attrs:{cols:"12",sm:"12"}},[e(m,{staticClass:"mx-auto",attrs:{tile:""}},[e(b,{attrs:{headers:t.headers,items:t.layouts,"item-key":"pdfdocumentLayoutId","hide-default-footer":!0,"items-per-page":5,"no-data-text":"Geen PDF layouts beschikbaar"},scopedSlots:t._u([{key:"item.actions",fn:function({item:a}){return[e(s,{attrs:{small:""},on:{click:function(n){return n.stopPropagation(),t.updatePDFDocumentLayout(a.pdfdocumentLayoutId)}}},[t._v(" Update ")]),e(s,{attrs:{small:""},on:{click:function(n){return t.deletePDFDocumentLayout(a.pdfdocumentLayoutId)}}},[t._v(" Verwijderen ")])]}}],null,!0)})],1)],1)],1)},V=[],j=d(I,R,V,!1,null,null,null,null);const g=j.exports,B={name:"adminDocTemplateView",data(){return{}},components:{PDFDocumentLayoutList:g}};var E=function(){var t=this,e=t._self._c;return e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.isLoading,expression:"$store.state.isLoading"}],staticClass:"text-center"},[e($,{attrs:{size:70,width:7,indeterminate:"",color:"grey"}})],1),e("div",[e(m,{staticClass:"pa-2",attrs:{outlined:"",tile:""}},[e(P,{attrs:{left:""}},[t._v("Beheer de document templates")]),e("div",[e(g)],1)],1)],1)])},N=[],O=d(B,E,N,!1,null,null,null,null);const Y=O.exports;export{Y as default};
